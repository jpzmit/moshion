<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Moshion Dashboard</title>
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="assets/img/Logo.jpg" />
        <!-- Bootstrap Icons-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Merriweather+Sans:400,700" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic" rel="stylesheet" type="text/css" />
        <!-- SimpleLightbox plugin CSS-->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/SimpleLightbox/2.1.0/simpleLightbox.min.css" rel="stylesheet" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />
        <!--link href="css/mystyles.css" rel="stylesheet" /-->
        <!-- link href="css/mystyles.css" rel="stylesheet" /-->
    </head>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js";
        import { getDatabase, ref, onValue,onChildAdded,query,limitToLast } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-database.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
          apiKey: "AIzaSyBH5a1C-FRm-hmWj2M-gRC1AicaVWRcx84",
          authDomain: "moshiontest.firebaseapp.com",
          databaseURL: "https://moshiontest-default-rtdb.firebaseio.com",
          projectId: "moshiontest",
          storageBucket: "moshiontest.appspot.com",
          messagingSenderId: "799744570002",
          appId: "1:799744570002:web:63954c20ccbf0df7da6c4b",
          measurementId: "G-7PJ1C17QP6"
        };
        const app = initializeApp(firebaseConfig);
        // Initialize Firebase
        const db = getDatabase(app); 

        //Finish Firebase setup

        //update matrix data
        const sensordata = ref(db, 'test_user');
        for (let i = 1; i < 9; i++){    
            const sensordata_row1 = ref(db, 'test_user/row'+i);
            onValue(sensordata_row1, (snapshot) => {
                    const childVal = snapshot.val();
                    for (let j = 1; j < 9; j++) {
                         document.getElementById("row"+ i + "col" + j).innerHTML=childVal["col"+j];
                            if (childVal["col"+j] > 400){
                            document.getElementById("row"+ i + "col" + j).style.backgroundColor = "red";
                            }
                            else if (childVal["col"+j] < 400 && childVal["col"+j] >200){
                                document.getElementById("row"+ i + "col" + j).style.backgroundColor = "orange";
                            } 
                            else {
                                document.getElementById("row"+ i + "col" + j).style.backgroundColor = "DarkGreen";
                            }
                    }    
            });
        }; 
    
    //coloring the matrix
    
    </script>

    
    <body id="page-top">
        <nav class="navbar navbar-expand-lg navbar-light py-3" id="mainNav">
            <div class="container px-4 px-lg-5">
                <a class="navbar-brand" href="#page-top">
                    <img src="assets/img/Logo.svg" alt="" height=120px > 
                </a>
                <button class="navbar-toggler navbar-toggler-right navbar-dark bg-dark" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav ms-auto my-2 my-lg-0">
                        <li class="nav-item"><a class="nav-link" href="#">Home</a></li>
                        <li class="nav-item"><a class="nav-link" href="#portfolio">Vision</a></li>
                        <li class="nav-item"><a class="nav-link" href="#product-details">Solution</a></li>
                        <li class="nav-item"><a class="nav-link" href="#AboutUs">About Us</a></li>
                    </ul>
                </div>
            </div>
        </nav>  
        <section id="TimeHistory">
            <div class="container mt-5 px-4 px-lg-5 h-100">
                <div class="row gx-4 gx-lg-5 h-100 align-items-center justify-content-center text-center">
                        <iframe width="1200" height="900" 
                        src="https://datastudio.google.com/embed/reporting/828573b8-3775-4f45-9c53-2c8ac1626ff1/page/5s0oC" 
                        frameborder="0" style="border:0" allowfullscreen>
                        </iframe>
                        <hr class="divider" />
                </div>
            </div>
        </section>    
        <section id="jumbotron">
            <div class="container mt-5 px-4 px-lg-5 h-100">
                <div class="row gx-4 gx-lg-5 h-100 align-items-center justify-content-center text-center">
                    <div >
                        <h2 class="text-white">Pressure Heatmap</h2>
                        <hr class="divider" />
                    </div>
                </div>
            </div>
        </section>
        
    <Section id="Matrix"> 
        <script src="js/scripts.js"></script>       
    </Section> 

    <div class ="container justify-content-center text-center">
        <h3>
            <br>
            Front
        </h3>
    </div>
    <!-- End of matrix display-->
    
    
    <!--Refresh-->
    </body>
</html>